zabbix_export:
  version: '5.4'
  date: '2022-04-21T22:29:13Z'
  groups:
    -
      uuid: 4f154a7b0323444cac18f8fb2b03796f
      name: antivirus
  templates:
    -
      uuid: d337f21afdea40c1bb066f681a38548e
      template: ESET
      name: ESET
      groups:
        -
          name: antivirus
      items:
        -
          uuid: 6d080b7d3e8a42a4afeb355a43839729
          name: 'Aggiornamenti Risultato ultimo tentativo'
          type: DEPENDENT
          key: aggiornamento.risultato
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.result.last_update_result
          master_item:
            key: 'system.run[C:\PROGRA~1\ESET\ESETSE~1\eRmm.exe get update-status]'
          tags:
            -
              tag: Antivirus
              value: ESET
            -
              tag: ESET
              value: Aggiornamenti
        -
          uuid: 06298da0faa347e9b4941dc8812a92b8
          name: 'Aggiornamenti ultimo eseguito con successo'
          type: DEPENDENT
          key: aggiornamento.riuscito
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.result.last_successful_update_time
          master_item:
            key: 'system.run[C:\PROGRA~1\ESET\ESETSE~1\eRmm.exe get update-status]'
          tags:
            -
              tag: Antivirus
              value: ESET
            -
              tag: ESET
              value: Aggiornamenti
        -
          uuid: 953c1b13a59945b782db036464cc52c8
          name: 'Aggiornamenti Ultimo Tentativo ESET'
          type: DEPENDENT
          key: aggiornamento.tentato
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.result.last_update_time
          master_item:
            key: 'system.run[C:\PROGRA~1\ESET\ESETSE~1\eRmm.exe get update-status]'
          tags:
            -
              tag: Antivirus
              value: ESET
            -
              tag: ESET
              value: Aggiornamenti
        -
          uuid: 90d9c655f86a42999520aa575defc867
          name: 'Licenza ESET EDTD ID Publico'
          type: DEPENDENT
          key: ESET.licenza.edtd.publicid
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.result.edtd.public_id
          master_item:
            key: 'system.run[C:\PROGRA~1\ESET\ESETSE~1\eRmm.exe get license-info]'
          tags:
            -
              tag: Antivirus
              value: ESET
            -
              tag: ESET
              value: Licenza
        -
          uuid: 1becefacf3b54ee19f54e7330eb204f9
          name: 'Licenza ESET EDTD ID Postazione'
          type: DEPENDENT
          key: ESET.licenza.edtd.seatid
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.result.edtd.seat_id
          master_item:
            key: 'system.run[C:\PROGRA~1\ESET\ESETSE~1\eRmm.exe get license-info]'
          tags:
            -
              tag: Antivirus
              value: ESET
            -
              tag: ESET
              value: Licenza
        -
          uuid: 066081b7e5d247ae8582692347bdd944
          name: 'Licenza ESET EDTD Nome Postazione'
          type: DEPENDENT
          key: ESET.licenza.edtd.seat_name
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.result.edtd.seat_name
          master_item:
            key: 'system.run[C:\PROGRA~1\ESET\ESETSE~1\eRmm.exe get license-info]'
          tags:
            -
              tag: Antivirus
              value: ESET
            -
              tag: ESET
              value: Licenza
        -
          uuid: 0132e80e93a74b908b088fc0a59949f6
          name: 'Licenza ESET EDTD Stato'
          type: DEPENDENT
          key: ESET.licenza.edtd.state
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.result.edtd.expiration_state
          master_item:
            key: 'system.run[C:\PROGRA~1\ESET\ESETSE~1\eRmm.exe get license-info]'
          tags:
            -
              tag: Antivirus
              value: ESET
            -
              tag: ESET
              value: Licenza
        -
          uuid: 9a5bec75274d4688a62d7d6530e46e40
          name: 'Licenza ESET EDTD Tipo'
          type: DEPENDENT
          key: ESET.licenza.edtd.type
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.result.edtd.type
            -
              type: STR_REPLACE
              parameters:
                - FULL_PAID
                - 'A Pagamento'
          master_item:
            key: 'system.run[C:\PROGRA~1\ESET\ESETSE~1\eRmm.exe get license-info]'
          tags:
            -
              tag: Antivirus
              value: ESET
            -
              tag: ESET
              value: Licenza
        -
          uuid: 99316e1d60864a7887eaf4a10fd09242
          name: 'Licenza ESET ID Pubblico'
          type: DEPENDENT
          key: ESET.licenza.publicID
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.result.public_id
          master_item:
            key: 'system.run[C:\PROGRA~1\ESET\ESETSE~1\eRmm.exe get license-info]'
          tags:
            -
              tag: Antivirus
              value: ESET
            -
              tag: ESET
              value: Licenza
        -
          uuid: 56c1ac69a03e49fc9d700b7706b303a1
          name: 'Licenza ESET ID Postazione'
          type: DEPENDENT
          key: ESET.licenza.seatID
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.result.seat_id
          master_item:
            key: 'system.run[C:\PROGRA~1\ESET\ESETSE~1\eRmm.exe get license-info]'
          tags:
            -
              tag: Antivirus
              value: ESET
            -
              tag: ESET
              value: Licenza
        -
          uuid: d6c2890cd9984521aad73c566b712cf1
          name: 'Licenza ESET Nome Postazione'
          type: DEPENDENT
          key: ESET.licenza.seatname
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.result.seat_name
          master_item:
            key: 'system.run[C:\PROGRA~1\ESET\ESETSE~1\eRmm.exe get license-info]'
          tags:
            -
              tag: Antivirus
              value: ESET
            -
              tag: ESET
              value: Licenza
        -
          uuid: eb02f148457a462f8f6e97e760f952b1
          name: 'Licenza ESET Stato'
          type: DEPENDENT
          key: ESET.licenza.stato
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.result.expiration_state
          master_item:
            key: 'system.run[C:\PROGRA~1\ESET\ESETSE~1\eRmm.exe get license-info]'
          tags:
            -
              tag: Antivirus
              value: ESET
            -
              tag: ESET
              value: Licenza
          triggers:
            -
              uuid: 3511df60e8fb4ea98c9fd3b9143d5069
              expression: 'last(/ESET/ESET.licenza.stato)<>"ok"'
              name: 'Licenza ESET in scadenza'
              priority: AVERAGE
              manual_close: 'YES'
              tags:
                -
                  tag: Antivirus
                  value: ESET
                -
                  tag: ESET
                  value: Alert
        -
          uuid: 876b533b14444539bd0debf5c30d42bc
          name: 'Licenza ESET Tipo'
          type: DEPENDENT
          key: ESET.licenza.tipo
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.result.type
            -
              type: STR_REPLACE
              parameters:
                - PAID
                - 'A Pagamento'
          master_item:
            key: 'system.run[C:\PROGRA~1\ESET\ESETSE~1\eRmm.exe get license-info]'
          tags:
            -
              tag: Antivirus
              value: ESET
            -
              tag: ESET
              value: Licenza
        -
          uuid: 15e4f17250f04175bf1fc212368673e9
          name: 'Minaccia Rilevamento'
          type: DEPENDENT
          key: ESET.Rilevamento
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.result.virlog.display_name
              error_handler: CUSTOM_VALUE
              error_handler_params: 'Nessun Minaccia'
            -
              type: REGEX
              parameters:
                - Rilevamenti
                - 'Minaccia Rilevata'
              error_handler: CUSTOM_VALUE
              error_handler_params: 'Nessun Minaccia'
          master_item:
            key: 'system.run[powershell -NoProfile -ExecutionPolicy bypass -File "C:\PROGRA~1\ZABBIX~1\script\checkviruslog.ps1" -time_check 5]'
          tags:
            -
              tag: Antivirus
              value: ESET
            -
              tag: ESET
              value: Minaccia
          triggers:
            -
              uuid: 76870bf5a3c74b3888e9e36771d5e9bf
              expression: 'last(/ESET/ESET.Rilevamento)="Minaccia Rilevata"'
              name: 'Minaccia Rilevata'
              priority: AVERAGE
              manual_close: 'YES'
              tags:
                -
                  tag: Antivirus
                  value: ESET
                -
                  tag: ESET
                  value: Alert
        -
          uuid: 01e15229e5cf47bfb14a35fa3671d5e9
          name: 'Minaccia Azione Intrapresa'
          type: DEPENDENT
          key: ESET.Rilevamento.azioneintrapresa
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.result.virlog.logs[0].[''Action Taken'']'
          master_item:
            key: 'system.run[powershell -NoProfile -ExecutionPolicy bypass -File "C:\PROGRA~1\ZABBIX~1\script\checkviruslog.ps1" -time_check 5]'
          tags:
            -
              tag: Antivirus
              value: ESET
            -
              tag: ESET
              value: Minaccia
        -
          uuid: 66e8e9d464714607af1d3935e0fa19b0
          name: 'Minaccia Circostanza'
          type: DEPENDENT
          key: ESET.Rilevamento.circostanza
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.result.virlog.logs[0].Circumstances'
            -
              type: STR_REPLACE
              parameters:
                - 'Event occurred during an attempt to access the web.'
                - 'Rilevato durante l''accesso ad un link.'
          master_item:
            key: 'system.run[powershell -NoProfile -ExecutionPolicy bypass -File "C:\PROGRA~1\ZABBIX~1\script\checkviruslog.ps1" -time_check 5]'
          tags:
            -
              tag: Antivirus
              value: ESET
            -
              tag: ESET
              value: Minaccia
        -
          uuid: e9f8c2ec31244d00b74a759706616f0e
          name: 'Minaccia Data e ora Rilevamento'
          type: DEPENDENT
          key: ESET.Rilevamento.dataora
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.result.virlog.logs[0].Time'
          master_item:
            key: 'system.run[powershell -NoProfile -ExecutionPolicy bypass -File "C:\PROGRA~1\ZABBIX~1\script\checkviruslog.ps1" -time_check 5]'
          tags:
            -
              tag: Antivirus
              value: ESET
            -
              tag: ESET
              value: Minaccia
        -
          uuid: f3142d4cc23241c897a72bfb8477a532
          name: 'Minaccia Hash'
          type: DEPENDENT
          key: ESET.Rilevamento.hash
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.result.virlog.logs[0].Hash'
          master_item:
            key: 'system.run[powershell -NoProfile -ExecutionPolicy bypass -File "C:\PROGRA~1\ZABBIX~1\script\checkviruslog.ps1" -time_check 5]'
          tags:
            -
              tag: Antivirus
              value: ESET
            -
              tag: ESET
              value: Minaccia
        -
          uuid: 352362eedc354896956da8b256981d4a
          name: 'Minaccia Nome'
          type: DEPENDENT
          key: ESET.Rilevamento.nomeminaccia
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.result.virlog.logs[0].[''Threat Name'']'
          master_item:
            key: 'system.run[powershell -NoProfile -ExecutionPolicy bypass -File "C:\PROGRA~1\ZABBIX~1\script\checkviruslog.ps1" -time_check 5]'
          tags:
            -
              tag: Antivirus
              value: ESET
            -
              tag: ESET
              value: Minaccia
        -
          uuid: 6effe863f9504f13882d267152af5a2d
          name: 'Minaccia Nome Processo'
          type: DEPENDENT
          key: ESET.Rilevamento.nomeprocesso
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.result.virlog.logs[0].[''Process Name'']'
          master_item:
            key: 'system.run[powershell -NoProfile -ExecutionPolicy bypass -File "C:\PROGRA~1\ZABBIX~1\script\checkviruslog.ps1" -time_check 5]'
          tags:
            -
              tag: Antivirus
              value: ESET
            -
              tag: ESET
              value: Minaccia
        -
          uuid: 6298113634ad449293f8f6465ecfeee4
          name: 'Minaccia Tipologia'
          type: DEPENDENT
          key: ESET.Rilevamento.tipominaccia
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.result.virlog.logs[0].[''Threat Type'']'
          master_item:
            key: 'system.run[powershell -NoProfile -ExecutionPolicy bypass -File "C:\PROGRA~1\ZABBIX~1\script\checkviruslog.ps1" -time_check 5]'
          tags:
            -
              tag: Antivirus
              value: ESET
            -
              tag: ESET
              value: Minaccia
        -
          uuid: 4b092f11e7954d868d16aa00b9e16705
          name: 'Minaccia URL'
          type: DEPENDENT
          key: ESET.Rilevamento.urlminaccia
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.result.virlog.logs[0].[''Object URI'']'
          master_item:
            key: 'system.run[powershell -NoProfile -ExecutionPolicy bypass -File "C:\PROGRA~1\ZABBIX~1\script\checkviruslog.ps1" -time_check 5]'
          tags:
            -
              tag: Antivirus
              value: ESET
            -
              tag: ESET
              value: Minaccia
        -
          uuid: 1f63a69fe2554320a2d5dfbcc3978af4
          name: 'Minaccia Utente Incriminato'
          type: DEPENDENT
          key: ESET.Rilevamento.utente
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.result.virlog.logs[0].[''User Name'']'
          master_item:
            key: 'system.run[powershell -NoProfile -ExecutionPolicy bypass -File "C:\PROGRA~1\ZABBIX~1\script\checkviruslog.ps1" -time_check 5]'
          tags:
            -
              tag: Antivirus
              value: ESET
            -
              tag: ESET
              value: Minaccia
        -
          uuid: 6b8f9636ad3544acbacd86cb13e5419f
          name: 'Info Lingua Endpoint ESET'
          type: DEPENDENT
          key: info.endpoint.lang
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.result.lang_id
            -
              type: STR_REPLACE
              parameters:
                - '1040'
                - Italiano
          master_item:
            key: 'system.run[C:\PROGRA~1\ESET\ESETSE~1\eRmm.exe get application-info]'
          tags:
            -
              tag: Antivirus
              value: ESET
            -
              tag: ESET
              value: Info
        -
          uuid: c917751e7d5e47d79682c6414eae95e1
          name: 'Info Prodotto Endpoint ESET'
          type: DEPENDENT
          key: prodotto.endpoint
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.result.description
          master_item:
            key: 'system.run[C:\PROGRA~1\ESET\ESETSE~1\eRmm.exe get application-info]'
          tags:
            -
              tag: Antivirus
              value: ESET
            -
              tag: ESET
              value: Info
        -
          uuid: 0c47c1ff25984b0e9d29e1984d5145fb
          name: 'Stato del servizio ESET'
          key: 'service.info["ekrn",state]'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: STR_REPLACE
              parameters:
                - '0'
                - 'In Esecuzione'
          tags:
            -
              tag: Antivirus
              value: ESET
            -
              tag: ESET
              value: Componenti
          triggers:
            -
              uuid: b1a6da95b2aa42d1a0e39da3f3c6ce4f
              expression: 'last(/ESET/service.info["ekrn",state])<>0'
              name: 'Servizio ESET Disattivato'
              priority: AVERAGE
              tags:
                -
                  tag: Antivirus
                  value: ESET
                -
                  tag: ESET
                  value: Alert
        -
          uuid: af480033710c4612b3f76adaa4acba23
          name: 'Log Info Endpoint ESET'
          key: 'system.run[C:\PROGRA~1\ESET\ESETSE~1\eRmm.exe get application-info]'
          delay: 10s
          trends: '0'
          value_type: TEXT
          tags:
            -
              tag: Antivirus
              value: ESET
            -
              tag: ESET
              value: Log
        -
          uuid: 2f8586d7dd3a45eab6132d8e29f1185c
          name: 'Log Licenza Endpoint ESET'
          key: 'system.run[C:\PROGRA~1\ESET\ESETSE~1\eRmm.exe get license-info]'
          delay: 10s
          trends: '0'
          value_type: TEXT
          tags:
            -
              tag: Antivirus
              value: ESET
            -
              tag: ESET
              value: Log
        -
          uuid: 25bd98a5a67f4689898db9e23317c9b7
          name: 'Log Stato Protezione Endpoint ESET'
          key: 'system.run[C:\PROGRA~1\ESET\ESETSE~1\eRmm.exe get protection-status]'
          delay: 10s
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.result.description
            -
              type: STR_REPLACE
              parameters:
                - 'You are protected'
                - 'Protezione attiva'
            -
              type: STR_REPLACE
              parameters:
                - 'Security alert'
                - 'Protezione Disattivata'
          tags:
            -
              tag: Antivirus
              value: ESET
            -
              tag: ESET
              value: Log
          triggers:
            -
              uuid: 030204a8ce04441682ba96c8feee9b11
              expression: 'last(/ESET/system.run[C:\PROGRA~1\ESET\ESETSE~1\eRmm.exe get protection-status],#10)<>"Protezione attiva"'
              name: 'Protezione ESET Disattivata'
              priority: AVERAGE
              tags:
                -
                  tag: Antivirus
                  value: ESET
                -
                  tag: ESET
                  value: Alert
        -
          uuid: a347a675c06c40c599bf450b4f36346a
          name: 'Log Aggiornamenti Endpoint ESET'
          key: 'system.run[C:\PROGRA~1\ESET\ESETSE~1\eRmm.exe get update-status]'
          delay: 10s
          trends: '0'
          value_type: TEXT
          tags:
            -
              tag: Antivirus
              value: ESET
            -
              tag: ESET
              value: Log
        -
          uuid: 4ce156316b264a74be6418ae898caa76
          name: 'Deploy ESET Script'
          key: 'system.run[mkdir C:\PROGRA~1\ZABBIX~1\script & powershell.exe -NoProfile -ExecutionPolicy Bypass -command Invoke-WebRequest -Uri ''https://raw.githubusercontent.com/clanto/ESET_Protect_Script/main/zabbix/checkviruslog.ps1'' -OutFile "$Env:Programfiles\ZABBIX~1\script\checkviruslog.ps1",nowait]'
          delay: 1d
          trends: '0'
          value_type: LOG
          tags:
            -
              tag: Antivirus
              value: ESET
            -
              tag: ESET
              value: Componenti
        -
          uuid: 2031d98868384d90be6e06f95d035e9e
          name: 'Log Minacce ultimi 5 minuti'
          key: 'system.run[powershell -NoProfile -ExecutionPolicy bypass -File "C:\PROGRA~1\ZABBIX~1\script\checkviruslog.ps1" -time_check 5]'
          delay: 10s
          trends: '0'
          value_type: TEXT
          tags:
            -
              tag: Antivirus
              value: ESET
            -
              tag: ESET
              value: Log
        -
          uuid: 439af774444d4e58bff22e4a7a8c7c56
          name: 'Info Versione Endpoint ESET'
          type: DEPENDENT
          key: versione.endpoint
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.result.version
          master_item:
            key: 'system.run[C:\PROGRA~1\ESET\ESETSE~1\eRmm.exe get application-info]'
          tags:
            -
              tag: Antivirus
              value: ESET
            -
              tag: ESET
              value: Info
